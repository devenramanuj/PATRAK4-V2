<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>આંગણવાડી Patrak-4</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <div id="passwordOverlay">
        <div class="password-card">
            <div class="lock-icon-bg"><span class="material-icons">lock</span></div>
            <h2>આંગણવાડી Patrak-4</h2>
            <p class="pass-note">આ એપ. પાસવર્ડથી સુરક્ષિત છે</p>
            <div class="input-group">
                <input type="password" id="passwordInput" placeholder="પાસવર્ડ લખો">
                <button id="passwordSubmit"><span class="material-icons">arrow_forward</span></button>
            </div>
            <div id="passwordError" class="error-message">ખોટો પાસવર્ડ!</div>
            <div class="contact-box"><p>પાસવર્ડ માટે સંપર્ક</p><p class="number">mo. 9276505035</p></div>
        </div>
    </div>

    <div id="aiAssistant">
        <div class="assistant-icon"><span class="material-icons">smart_toy</span></div>
        <div class="assistant-container">
            <div class="assistant-header">
                <div style="display:flex; align-items:center; gap:10px;"><span class="material-icons">smart_toy</span><h3>સહાયક</h3></div>
                <div class="assistant-close"><span class="material-icons">close</span></div>
            </div>
            <div class="assistant-messages" id="assistantMessages"></div>
            <div class="assistant-input">
                <input type="text" id="assistantInput" placeholder="લખો..." onkeypress="handleAssistantKeypress(event)">
                <button onclick="sendMessage()" style="border:none; background:none; color:#FF6B6B;"><span class="material-icons">send</span></button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1 style="font-size: 1.5rem; margin:0;">આંગણવાડી Patrak-4</h1>
            <div style="font-size:0.8rem; opacity:0.8;">Developed by Devendra Ramanuj</div>
        </header>

        <nav>
            <button class="nav-btn active" onclick="showPage('homePage')"><span class="material-icons">home</span><span class="nav-label">હોમ</span></button>
            <button class="nav-btn" onclick="showPage('beneficiaryPage')"><span class="material-icons">people</span><span class="nav-label">લાભાર્થી</span></button>
            <button class="nav-btn" onclick="showPage('stockPage')"><span class="material-icons">inventory</span><span class="nav-label">સ્ટોક</span></button>
            <button class="nav-btn" onclick="showPage('matruMandalStockPage')"><span class="material-icons">inventory_2</span><span class="nav-label">માતૃમંડળ</span></button>
            <button class="nav-btn" onclick="showPage('reportPage')"><span class="material-icons">assessment</span><span class="nav-label">રિપોર્ટ</span></button>
            <button class="nav-btn" onclick="showPage('billPage')"><span class="material-icons">receipt</span><span class="nav-label">બિલ</span></button>
            <button class="nav-btn" onclick="showPage('toolsPage')"><span class="material-icons">build</span><span class="nav-label">ટૂલ્સ</span></button>
        </nav>

        <div id="homePage" class="page active">
            <div class="card">
                <h2>મેનુ</h2>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <div class="feature-card" onclick="showPage('beneficiaryPage')"><span class="material-icons" style="font-size:2rem; color:#3498db;">people</span><p>લાભાર્થી</p></div>
                    <div class="feature-card" onclick="showPage('stockPage')"><span class="material-icons" style="font-size:2rem; color:#e67e22;">inventory</span><p>સ્ટોક</p></div>
                    <div class="feature-card" onclick="showPage('reportPage')"><span class="material-icons" style="font-size:2rem; color:#2ecc71;">assessment</span><p>રિપોર્ટ</p></div>
                    <div class="feature-card" onclick="showPage('billPage')"><span class="material-icons" style="font-size:2rem; color:#9b59b6;">receipt</span><p>બિલ</p></div>
                </div>
            </div>
            <div class="card">
                <h2>માહિતી</h2>
                <div style="display:flex; flex-direction:column; gap:10px;">
                    <input type="text" id="centerNameHome" placeholder="આંગણવાડીનું નામ">
                    <input type="text" id="workerNameHome" placeholder="કાર્યકરનું નામ">
                    <input type="text" id="sejoHome" placeholder="સેજો">
                    <input type="text" id="centerCodeHome" placeholder="કોડ">
                    <button class="btn btn-success" onclick="saveCenterInfo()">માહિતી સેવ કરો</button>
                </div>
            </div>
        </div>

        <div id="beneficiaryPage" class="page">
            <div class="card">
                <div class="calendar-nav-header" style="display:flex; justify-content:space-between; align-items:center; background:#e3f2fd; padding:10px; border-radius:8px; margin-bottom:15px;">
                    <button class="btn" onclick="changeMonth(-1)" style="padding:5px 10px;">&#10094;</button>
                    <div style="text-align:center;">
                        <h3 id="calendarMonthDisplay" style="margin:0; font-size:1.2rem; color:#1565c0;">-</h3>
                        <span id="calendarYearDisplay" style="font-size:0.9rem;">-</span>
                    </div>
                    <button class="btn" onclick="changeMonth(1)" style="padding:5px 10px;">&#10095;</button>
                </div>
                <div style="display:none;"><select id="monthSelector"></select><select id="yearSelector"></select></div>
                <div id="calendarContainer"></div>
                <div style="text-align:center; margin-top:15px; padding:10px; background:#e8f5e9; border-radius:8px; font-weight:bold;">
                    કુલ લાભાર્થી: <span id="totalCount" style="color:#2e7d32; font-size:1.2rem;">0</span>
                </div>
            </div>
        </div>

        <div id="stockPage" class="page">
            <div class="card">
                <h2>સ્ટોક</h2>
                <div style="display:none;"><select id="stockMonthSelector"></select><select id="stockYearSelector"></select></div>
                <div class="stock-grid">
                    <div class="stock-item wheat"><b>ઘઉં</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="wheat_open" oninput="saveStockData(); updateStockTotals()">
                        <input placeholder="આવક" type="number" id="wheat_income" oninput="saveStockData(); updateStockTotals()">
                    </div>
                    <div class="stock-item rice"><b>ચોખા</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="rice_open" oninput="saveStockData(); updateStockTotals()">
                        <input placeholder="આવક" type="number" id="rice_income" oninput="saveStockData(); updateStockTotals()">
                    </div>
                    <div class="stock-item oil"><b>તેલ</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="oil_open" oninput="saveStockData(); updateStockTotals()">
                        <input placeholder="આવક" type="number" id="oil_income" oninput="saveStockData(); updateStockTotals()">
                    </div>
                    <div class="stock-item chana"><b>ચણા</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="chana_open" oninput="saveStockData(); updateStockTotals()">
                        <input placeholder="આવક" type="number" id="chana_income" oninput="saveStockData(); updateStockTotals()">
                    </div>
                    <div class="stock-item dal"><b>દાળ</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="dal_open" oninput="saveStockData(); updateStockTotals()">
                        <input placeholder="આવક" type="number" id="dal_income" oninput="saveStockData(); updateStockTotals()">
                    </div>
                </div>
                <div style="margin-top:15px; padding:10px; background:#e0f7fa; border-radius:8px;">
                    <b>કુલ સ્ટોક:</b><div id="stockTotals" style="font-size:0.9rem; margin-top:5px;"></div>
                </div>
            </div>
        </div>

        <div id="matruMandalStockPage" class="page">
            <div class="card">
                <h2>માતૃમંડળ</h2>
                <div style="display:none;"><select id="matruMandalStockMonthSelector"></select><select id="matruMandalStockYearSelector"></select></div>
                <div class="stock-grid">
                    <div class="stock-item singdana"><b>શીંગદાણા</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="singdana_open" oninput="saveMatruMandalStockData(); updateMatruMandalStockTotals()">
                        <input placeholder="આવક" type="number" id="singdana_income" oninput="saveMatruMandalStockData(); updateMatruMandalStockTotals()">
                    </div>
                    <div class="stock-item tal"><b>તલ</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="tal_open" oninput="saveMatruMandalStockData(); updateMatruMandalStockTotals()">
                        <input placeholder="આવક" type="number" id="tal_income" oninput="saveMatruMandalStockData(); updateMatruMandalStockTotals()">
                    </div>
                    <div class="stock-item gol"><b>ગોળ</b><br>
                        <input placeholder="ઓપનિંગ" type="number" id="gol_open" oninput="saveMatruMandalStockData(); updateMatruMandalStockTotals()">
                        <input placeholder="આવક" type="number" id="gol_income" oninput="saveMatruMandalStockData(); updateMatruMandalStockTotals()">
                    </div>
                </div>
                <div style="margin-top:15px; padding:10px; background:#e0f7fa; border-radius:8px;">
                    <b>કુલ સ્ટોક:</b><div id="matruMandalStockTotals" style="font-size:0.9rem; margin-top:5px;"></div>
                </div>
            </div>
        </div>

        <div id="reportPage" class="page">
            <div class="card">
                <h2>રિપોર્ટ</h2>
                <div style="display:none;"><select id="reportMonthSelector"></select><select id="reportYearSelector"></select></div>
                <div style="display:flex; gap:5px; flex-wrap:wrap; margin-bottom:10px;">
                    <input type="date" id="reportDate" style="flex:1;">
                </div>
                <div style="display:flex; gap:5px;">
                    <button onclick="generateReport(true)" class="btn" style="flex:1; font-size:0.9rem;">દૈનિક</button>
                    <button onclick="generateReport(false)" class="btn" style="flex:1; font-size:0.9rem;">માસિક</button>
                </div>
            </div>
            <div class="card" style="padding:10px;">
                <div class="table-container" id="reportTableContainer" style="font-size:0.8rem;">
                    <p style="text-align:center; color:#888;">રિપોર્ટ બટન દબાવો</p>
                </div>
            </div>
            <div class="card" id="reportSummaryContainer" style="display:none;">
                <h3>સમરી</h3>
                <div class="table-container">
                    <table class="wide-table" id="reportSummaryTable"></table>
                </div>
            </div>
        </div>

        <div id="billPage" class="page">
            <div class="card">
                <h2>બિલ</h2>
                <div style="display:none;"><select id="billMonthSelector"></select><select id="billYearSelector"></select></div>
                <div style="display:grid; gap:10px;">
                    <input type="text" id="centerName" placeholder="કેન્દ્ર">
                    <input type="text" id="workerName" placeholder="કાર્યકર">
                    <input type="text" id="registerPage" value="1" placeholder="પાના નં">
                    <input type="text" id="supervisorName" value="abc" placeholder="સુપરવાઈઝર">
                    <input type="text" id="sejo" placeholder="સેજો">
                    <input type="date" id="certificateDate">
                </div>
                <div style="margin-top:15px; font-size:0.9rem;">
                    <table style="width:100%; border-collapse:collapse;">
                        <tr style="background:#eee;"><th>પ્રકાર</th><th>રકમ</th></tr>
                        <tr><td>1.00</td><td id="masala1Amount">0.00</td></tr>
                        <tr><td>1.60</td><td id="masala2Amount">0.00</td></tr>
                        <tr><td>1.30</td><td id="masala3Amount">0.00</td></tr>
                        <tr style="font-weight:bold;"><td>કુલ</td><td id="totalMasalaAmount">0.00</td></tr>
                    </table>
                </div>
                <div style="margin-top:15px; display:flex; gap:5px; flex-wrap:wrap;">
                    <button class="btn" onclick="generateMasala130Certificate()">1.30</button>
                    <button class="btn" onclick="generateMasala160Certificate()">1.60</button>
                    <button class="btn" onclick="generateMasala100Certificate()">1.00</button>
                </div>
            </div>
        </div>

        <div id="toolsPage" class="page">
            <div class="card">
                <h2>ટૂલ્સ</h2>
                <div style="background:#333; padding:10px; border-radius:10px; margin-bottom:20px;">
                    <div id="calcDisplay" style="background:#eee; padding:10px; text-align:right; font-size:1.5rem; margin-bottom:10px; font-family:monospace;">0</div>
                    <div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:5px;">
                        <button class="btn btn-secondary" onclick="clearCalculator()">C</button>
                        <button class="btn btn-secondary" onclick="deleteLast()">DEL</button>
                        <button class="btn btn-secondary" onclick="appendToDisplay('/')">/</button>
                        <button class="btn btn-secondary" onclick="appendToDisplay('*')">*</button>
                        <button class="btn" onclick="appendToDisplay('7')">7</button>
                        <button class="btn" onclick="appendToDisplay('8')">8</button>
                        <button class="btn" onclick="appendToDisplay('9')">9</button>
                        <button class="btn btn-secondary" onclick="appendToDisplay('-')">-</button>
                        <button class="btn" onclick="appendToDisplay('4')">4</button>
                        <button class="btn" onclick="appendToDisplay('5')">5</button>
                        <button class="btn" onclick="appendToDisplay('6')">6</button>
                        <button class="btn btn-secondary" onclick="appendToDisplay('+')">+</button>
                        <button class="btn" onclick="appendToDisplay('1')">1</button>
                        <button class="btn" onclick="appendToDisplay('2')">2</button>
                        <button class="btn" onclick="appendToDisplay('3')">3</button>
                        <button class="btn btn-success" onclick="calculateResult()" style="grid-row:span 2;">=</button>
                        <button class="btn" onclick="appendToDisplay('0')" style="grid-column:span 2;">0</button>
                        <button class="btn" onclick="appendToDisplay('.')">.</button>
                    </div>
                </div>
                <div style="border:1px solid #ddd; padding:10px; border-radius:8px; margin-bottom:15px;">
                    <h3>ઉંમર</h3>
                    <input type="date" id="birthDate"><input type="date" id="currentDate">
                    <button class="btn" style="width:100%; margin-top:5px;" onclick="calculateAge()">ગણો</button>
                    <div id="ageResult" style="text-align:center; font-weight:bold; margin-top:5px;">-</div>
                </div>
            </div>
        </div>

    </div>

    <div id="previewModal" class="certificate-modal" style="display: none;">
        <div class="certificate-container" style="width:100%; max-width:100%; height:100vh; margin:0; border-radius:0;">
            <button class="certificate-close" onclick="closePreview()">X</button>
            <div id="previewContent" style="border:1px solid #ccc; padding:10px; overflow:auto;"></div>
        </div>
    </div>

    <div id="certificateModal130" class="certificate-modal" style="display: none;">
        <div class="certificate-container">
            <button class="certificate-close" onclick="closeCertificate('certificateModal130')">×</button>
            <div class="certificate">
                <h3 style="text-align:center; border-bottom:1px solid #000;">મસાલા બિલ (1.30)</h3>
                <p>કેન્દ્ર: <span id="centerName130"></span></p>
                <p>તારીખ: <span id="certificateDate130"></span></p>
                <p>લાભાર્થી: <span id="beneficiaries130"></span> | દર: 1.30</p>
                <p>રકમ: <span id="submittedAmount130"></span></p>
                <br><br><div style="display:flex; justify-content:space-between;"><span>સુપરવાઈઝર</span><span>કાર્યકર</span></div>
            </div>
        </div>
    </div>
    <div id="certificateModal160" class="certificate-modal" style="display: none;">
        <div class="certificate-container">
            <button class="certificate-close" onclick="closeCertificate('certificateModal160')">×</button>
            <div class="certificate">
                <h3 style="text-align:center; border-bottom:1px solid #000;">મસાલા બિલ (1.60)</h3>
                <p>કેન્દ્ર: <span id="centerName160"></span></p>
                <p>તારીખ: <span id="certificateDate160"></span></p>
                <p>લાભાર્થી: <span id="beneficiaries160"></span> | દર: 1.60</p>
                <p>રકમ: <span id="submittedAmount160"></span></p>
                <br><br><div style="display:flex; justify-content:space-between;"><span>સુપરવાઈઝર</span><span>કાર્યકર</span></div>
            </div>
        </div>
    </div>
    <div id="certificateModal100" class="certificate-modal" style="display: none;">
        <div class="certificate-container">
            <button class="certificate-close" onclick="closeCertificate('certificateModal100')">×</button>
            <div class="certificate">
                <h3 style="text-align:center; border-bottom:1px solid #000;">મસાલા બિલ (1.00)</h3>
                <p>કેન્દ્ર: <span id="centerName100"></span></p>
                <p>તારીખ: <span id="certificateDate100"></span></p>
                <p>લાભાર્થી: <span id="beneficiaries100"></span> | દર: 1.00</p>
                <p>રકમ: <span id="submittedAmount100"></span></p>
                <br><br><div style="display:flex; justify-content:space-between;"><span>સુપરવાઈઝર</span><span>કાર્યકર</span></div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>
    <script src="script.js"></script>
</body>
</html>
